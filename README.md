# Telegram Mini App для Писателей

Это проект Телеграм-бота с Mini App, который помогает писателям с ослабленным зрением надиктовывать и редактировать тексты с помощью голоса и AI.

## Структура проекта

- `/frontend`: Код Mini App (HTML, CSS, JavaScript), который видит пользователь.
- `/backend`: Сервер на Python (FastAPI), который обрабатывает аудио и выполняет AI-задачи.

## Основные технологии

- **Frontend**: Vanilla JavaScript, HTML5, CSS3, `MediaRecorder API`.
- **Backend**: Python, FastAPI.
- **Распознавание речи (STT)**: OpenAI Whisper (локально).
- **Улучшение текста (LLM)**: Llama 3 (через Ollama).

---

## Как запустить проект локально

### 1. Установка AI-моделей (Ollama)

Для работы функции улучшения текста необходимо установить Ollama и скачать модель Llama 3.

1.  **Установить Ollama**: Скачайте приложение с официального сайта [ollama.com](https://ollama.com).
2.  **Скачать Llama 3**: В терминале выполните команду:
    ```bash
    ollama pull llama3
    ```
    Убедитесь, что приложение Ollama запущено в фоновом режиме.

### 2. Запуск бэкенда

1.  Перейдите в директорию `/backend`:
    ```bash
    cd backend
    ```
2.  Создайте и активируйте виртуальное окружение:
    ```bash
    python -m venv venv
    source venv/bin/activate  # macOS/Linux
    # venv\Scripts\activate    # Windows
    ```
3.  Установите все зависимости, включая `torch` и `whisper`:
    ```bash
    pip install -r requirements.txt
    ```
    *Примечание: Установка может занять продолжительное время.*

4.  Запустите сервер FastAPI:
    ```bash
    uvicorn main:app --reload
    ```
    Сервер будет доступен по адресу `http://127.0.0.1:8000`. При первом запуске он скачает модель Whisper `base`.

### 3. Запуск фронтенда

Самый простой способ — использовать расширение `Live Server` в вашем редакторе кода (например, в VS Code) для запуска файла `frontend/index.html`.

Либо вы можете запустить простой локальный сервер на Python:
```bash
# Находясь в корневой папке проекта
cd frontend
python -m http.server
```
Фронтенд будет доступен по адресу `http://localhost:8000` (или другому порту).

---

## Развертывание (Деплой) в Telegram

Чтобы вашим приложением можно было пользоваться прямо из Telegram, выполните следующие шаги:

### Шаг 1: Разместить Фронтенд

Используйте любой сервис для хостинга статических сайтов. Рекомендуемый бесплатный вариант — **GitHub Pages**.
1.  Создайте публичный репозиторий на GitHub.
2.  Загрузите в него содержимое папки `/frontend`.
3.  В настройках репозитория активируйте GitHub Pages для ветки `main`.
4.  Вы получите публичный URL вида `https://<your-username>.github.io/<repo-name>/`.

### Шаг 2: Сделать Бэкенд публичным

Так как для работы AI-моделей нужны значительные ресурсы, для бесплатного использования мы запустим бэкенд локально и "выставим" его в интернет с помощью **ngrok**.

1.  Скачайте и настройте `ngrok` с официального сайта [ngrok.com](https://ngrok.com).
2.  Убедитесь, что ваш локальный бэкенд запущен на порту `8000`.
3.  В новом терминале запустите `ngrok`:
    ```bash
    ngrok http 8000
    ```
4.  `ngrok` предоставит вам публичный URL (например, `https://abcdef123.ngrok-free.app`). **Этот URL будет работать, только пока запущен ngrok и ваш локальный сервер.**

### Шаг 3: Обновить URL в коде Фронтенда

1.  Откройте файл `frontend/editor.js`.
2.  Найдите переменную `BACKEND_URL`.
3.  **Замените** плейсхолдер `<ВАШ_АДРЕС>.ngrok-free.app` на ваш реальный URL, полученный от `ngrok`.
4.  Не забудьте перезалить обновленный `editor.js` на ваш хостинг (GitHub Pages).

### Шаг 4: Настроить Бота в Telegram

1.  Откройте диалог с `@BotFather` в Telegram.
2.  Создайте нового бота с помощью команды `/newbot`.
3.  Получите токен и настройте кнопку меню:
    - Отправьте `/mybots`, выберите вашего бота.
    - Перейдите в `Bot Settings` -> `Menu Button`.
    - Настройте кнопку, указав в качестве URL ссылку на ваш фронтендж с GitHub Pages.

После этих шагов ваше Mini App будет готово к использованию!
